\documentclass{mcmthesis}
\mcmsetup{CTeX = false, 
        tcn =57566, problem = B,
        sheet = true, titleinsheet = true, keywordsinsheet = true,
        titlepage = false, abstract = true}
\usepackage{palatino}
\usepackage{array}
\bibliographystyle{apalike}
\title{An optimized design of the area following the toll barrier }

\begin{document}

	
	
\begin{abstract}
	
In order to determine the optimal shape and the size of the toll plaza, this paper proposes a simulation model for New Jersey Turnpike Authority to ameliorate the performance of the toll station.

First, after referencing to the common designs of toll stations in current use and analyzing the differences, the plaza is simulated by a number of tollbooths of different types. Each tollbooth is configurable in the simulation for vehicle passage type, charging mode and lane direction which will direct the vehicles into the merging flow. The performance is evaluated by a weighted average of throughput index, accident rate index and cost index. The weights are determined by principal component analysis. 

The vehicles are simulated by a set of rectangles in a two-dimensional plane, with a moving strategy written based on car following (CF) model \footnote{Reuschel and Pipes in 1956, Herman and Rothory in 1960}, GM model \footnote{Gazis,Herman and Rothery} and Nagel-Schreckenberg (NS) model \footnote{K.Nagel and M.Schreckenberg in 1992}. The vehicles are generated by the tollbooth by a probabilist model, given a fixed traffic flow and then fired for the merge. The vehicles submit to possible collisions with other vehicles and the road boundary. Both autonomous cars and human-driven cars are simulated, equipped with adapted moving strategies.

With this generalized and adapted model, the throughput can be obtained on calculating the average throughput result of multiple simulations. The accident rate is obtained by a larger set of simplified simulations. The cost is calculated by the construction area and tollbooth number. The experiments on $MATLAB$ with different parameters of tollbooth and shape give an analysis of several design schemes, detailed in the report.

In the last part, with different parameters set, an improved design in terms of throughput is proposed on running an optimization algorithm. Various proportions of autonomous vehicles and tollbooths are also tested.


\begin{keywords}
;
\end{keywords}
\end{abstract}

\maketitle
\tableofcontents
\clearpage








\section{A letter to the New Jersey Turnpike Authority}


New Jersey Turnpike Authority,

Our team has proposed an optimized toll station design allowing the increase of throughput and the decrease of cost and accident rate. And a new mathematical model is built in order to help evaluate the performances of designs. 

More specifically, the performance model is developed after taking all important elements related to this problem into consideration, like number of lanes and tollbooths, proportions of tollbooths, varieties of vehicles, change of flows, every decision made by drivers to turn right or left and traffic conditions. 



\section{Introduction}

\subsection{Statement of the problem}

The design of toll plaza is undoubtedly a state of art as it is hard to find a balance among safety, capacity and cost, facing different situations. It also acts as an essential part in the high-way traffic system. Considering a better toll station design is in demand, mathematical methods and simulation models are implemented to optimize the design schemes, striving to increase the throughput, decrease the cost and accident rate.



\begin{itemize}

\item 
\end{itemize}







\begin{Theorem} \label{thm:latex}

\end{Theorem}

\begin{Lemma} \label{thm:tex}

\end{Lemma}

\begin{proof}
The proof of theorem.
\end{proof}

\subsection{Assumptions}

\begin{itemize}
	\item Assumptions for the toll station:
	\begin{itemize}
         \item Toll station has a fixed configuration for each simulation: vehicle type & charging process.
         \item Tollbooths allowing large vehicles are also available for smaller vehicles to pass.
       	 \item It takes a contain time for every vehicle to leave the tollbooth, an extra delay is caused by the charging process.
	\end{itemize}

    \item Assumptions for the vehicles.
    \begin{itemize}
    	\item The proportions of different types of vehicles are fixed along the time.
    	\item All vehicles are enabled for all 3 types of charging.
    	\item All vehicles leave the tollbooths with a given speed.
    	\item Each vehicle is regarded as a point located in the center of gravity, but the vehicles still have a volume.
    	\item The accelerations of all the vehicles depend on the others who surround themselves.Time is devided into 1 second, drivers' decisions in every second depend on the surroundings and the status are updated every second.
    	\item The biggest wheel steering angle is $45^{\circ}$, and the turning radius is negleted.
    	
    \end{itemize}
    \item Assumptions for the flow generating:
    \begin{itemize}
    \item A fixed total flow $F_t$ is uniformly distributed into seconds, which passes the tollbooths, and then gain the merging flow.
   	\item In cicumstances where traffic is light, the tollbooths the vehicles arrive are random.
    \item In circumsatances where traffic is busy, the vehicles begin to queue up before the tollbooths, therefore every tollbooth is allowing a maximun flow to pass following the proportiional.
    \item Light and heavy traffic is distinguished by a critical flow  $F_c$, which is determined by tollbooth simulation.
    \end{itemize}
	
	
\end{itemize}



Here we list the elements that will influence the throughput of our toll station:

\begin{tabular}{|m{7cm}<{\centering}|p{7cm}<{\centering}|}
	\hline
	Notations & Meanings \\
	\hline
	 $L$ &  Number of lanes \\
	\hline
	 $B$ &  Number of tollbooths\\
	 \hline
     $F_t$ & 	 Total flow\\
     \hline
     $F_c$ & Critical flow (the maximum of the total flow)\\
     \hline
     $P_l$,  $P_m$, $P_s$ & Probability of large-scale automobiles, midium-sized vehicles and compact cars\\
     \hline
     $v_{this}$, $a_{this}$ & Speed and acceleration of the vehicle we study\\
     \hline
      $v_n$, $a_n$ &  Speed and acceleration of the other vehicles which surround the vehicle we study\\
     \hline
     $pos_x$, $pos_y$ & We build a rectangular coordinate system  with the leftmost tollbooth constructed as the origin.\\
     \hline
     $L_{length}$ & Merging area length \\
     \hline

\end{tabular}


\section{Analysis of the Problem}
To respect the notion of "barrier", and to avoid the complexity of gradient, this article discusses only the toll stations of one storey. It is considered that the approach ramps would complicate the traffic flow in both edge of the station, and the cost would be enormous.

\begin{figure}[htbp]
\small
\centering
\caption{Toll station \cite{note}} \label{fig:Ts}
\includegraphics{img3.png}
\end{figure}


In the merging area, all the vehicles merging from $B$ tollbooths into $L$ lanes in a short distance of $L_length$ meters.
With lane width predifined as 2 meters, the merging area is defined as the area surrounded by two curves on a finite two-dimension plane. The curves are represented by two functions, which would be a parameter to be optimized in the problem.

To begin with, the traffic flow scale is fixed for each simulation experience. $F_t$ stands for the quantity of cars, of various size, passing through the tollbooths every fifteen minutes. The flows of large-scale automobiles, midium-sized vehicles and compact cars are $F_tP_l$, $F_tP_m$, $F_tP_s$.

Since only the traffic after the toll station is to be considered, details of incoming vehicles such as the queuing and proportion distribution are simplified in the model. As the assumptions stated, the proportion of vehicle size and the capability of autonomous driving are implemented by a probabilist model, of which the proportions are fixed by us. 

The vehicles are instancialized with concrete parameters after the tollbooth. That is to say, the traffic to be simulated in the experiences has only one parameter to be adjusted in the performance evaluation: the flow. Corresponding to each flow level, the simulation algorithm adjusts its strategy to generate the traffic. It is remarked that different vehicles takes different times to leave the booth, and the time difference arised by different charging method is also taken into consideration by adding a minimum time gap for each booth to allow the next passage.

The strategy is detailed as follows: for a fixed number of tollbooths in one performance evaluation experience, the maximum traffic is generated by allowing the passage of a maximum of vehicles through each tollbooth. Thus a critical flow [ç¬¦å·] denotes the expectation of maximum traffic. 

On cases where traffic flow configured for the simulation is greater than the critical flow, as assumed the traffic flow successfully finds an optimal queuing strategy, allowing each tollbooth to let pass vehicles continously meanwhile respecting the time gap for each vehicle. 

For other cases, the traffic is allocated into each second of the 15 minutes following a uniform fashion. With the assumption that all the vehicles arriving at the booth finds an approriate booth to pass through, and if the vehicle number in this second depasses the number of the tollbooth available, the extra vehicles are queued into the next second.

The vehicles are tagged with its size and nature whether it is human-driven on leaving the tollbooth. The two kinds of tags are independently proportionally distributed.

The merging flow are constituted by vehicles leaving the tollbooth. Since in the problem we are focusing on individual vehicle comportments in an area of 50m x 200m, the vehicles are not to be represented by moving points: the direction of the front of the vehicle, the direction of the speed and interactions from all orientations are to be taken into account.

It is suggested that at the moment where the vehicle leaves the booth, its speed and direction are restricted by the booth, since a speed limit is implemented and the car can only follow the shape of the lane passing through the booth. Thus, the shape of the booth are represented by the initial speed and direction of the vehicles. With each design of the toll station, an interpretation of initial speed and direction would be given.

In this article, an extented version of Car-following model is proposed, preserving the idea that driving consists of the process of perception, decision making and control. Based on the active vehicles on the road and the road shape, the driver's decision includes acceleration or deacceleration of the direction ahead and the one sideways.

A crucial difference of the model presented compared with the classic ones is that this model preserves the physical dimensions of the vehicle, and enables a relative free movement in a two-dimension plane, instead of a strict restraint of one lane. 

Response = coefficient Stimulus [å…¬å¼]

The human-driven vehicles are represented in the model by an approximation of their vertical projection, rectangles of different sizes. To implement the dynamics, Nagel-Schreckenberg (NS) model \cite{acelluar}, GM model and CF (car following) model are taken reference to simulate the driving strategies. The model presented by this paper considers the acceleration of each vehicle a compound decision of three factors: avoidance for collision with other vehicles interpreted as interactions between the vehicles, avoidance for collision with the road boundary, and its intrinsic willingness to achieve a maximum speed. 

The acceleration is represented mathematically by: 

$$\overrightarrow{a_{this}(t)}=\overrightarrow{a_i(t)}+\overrightarrow{a_r(t)}+\overrightarrow{a_a(t)}$$

For the interactions, the acceleration decision is made as an two dimensional extention of [REF]. The decision is contributed positively by the current speed, the relative speed in reference with other vehicles and nagatively by the corresponding distance and the cosinus of the relative position angle. This model agrees with the fact that the driver is more stimulated by near-by vehicles, and a deceleration of the vehicle ahead would cause a deceleration of the following vehicle, a fast vehicle would push away the slow vehicle aside. [ä¿®æ”¹]

Thus (this $\ne$ $n$),
$$\overrightarrow{a_i(t)}=\overrightarrow{a_{interaction}(t)}=\lambda (v_{this}(t))^m \times \sum_n\frac{v_n(t)-v_{this}(t)}{(d_n(t))^l}\times \overrightarrow{dir_{n,this}(t)}$$
$$d_{n}(t)=distance_n(t)=\sqrt{\delta pos_x(t)^2+\delta pos_y(t)^2}$$
$$\overrightarrow{dir_{n,this}(t)}=\frac{(pos_x-pos_{x,n},pos_y-pos_{y,n})}{\parallel (pos_{x,this}-pos_{x,n},pos_{y,this}-pos_{y,n}) \parallel} $$\\

It is also suggested by the safe-distance psychological model that the drivers drive away from the edge of the road, if the distance between the vehicle and the boundary is too small. The model treats the avoidance of the edge in a similar way of the previous acceleration.

$$\overrightarrow{a_r(t)}=\overrightarrow{a_{road}(t)}=\alpha \times distance_{baundary-left}^{-l'} \times v(t)^m'\times \overrightarrow{right} \times 1_{d<d_{critical}$$
	$$+\alpha \times distance_{baundary-right}^{-l'} \times v(t)^m'\times \overrightarrow{left} \times 1_{d<d_{critical}}$$
$$distance_{baundary}=\arrowvert pos_x-pos_{distance}(pos_y)} \arrowvert$$\\

It is also considered, that on leaving a speed limited zone, the vehicles are supposed to reattain a speed of normal level. This process is simulated by a positive factor of the gap of current speed and the ideal speed.

$$a_a(t)=a_{acceleration}(t)=\beta (v_{max}-v(t)) \times a_{max} \times \overrightarrow{forward}$$\\
Here $\lambda$, $l$,$m$, $\alpha$, $l'$, $m'$, $\beta$ and $a_{max}$ are the parameters that we can adjust.\\

The simulation model is based on a large amount of extensions based on current model, thus takes many parameters that is merely experimental.

\begin{figure}[htbp]
	\small 
	\centering
	\caption{Our simulation}
	\includegraphics{simulation.jpg}
\end{figure}


In order to propose a better design, the performance of the design can be addressed as a weighted average index of three factors: throughput, accident rate and cost. Through program simulations, the performance can be evaluated. On running optimization algorithms, the parameters could be addressed as the parameters to be optimized, which is promised to be of certain value.



\section{Validating the Model}

\subsection{Validating the simulation model}

In order to adjust the parameters and evaluate the performance of the two-dimensional car-following model, motion data of real-life driving must be abundantly supplied to test the model. However, a degradation of dimension can be mocked on setting the tollbooth number [ç¬¦å·] to 1 and the lane number [ç¬¦å·] to 1: the parameters are to be adjusted that the simulated vehicles run similarly with those simulated by a classic car-following model [å‚è€ƒæ–‡çŒ®ï¼Œå¾…è¡¥å……].

\subsection{Validating the optimization process}



\section{The Model Results}





\section{Conclusions}

\section{A Summary}


\section{Evaluate of the Model}

\section{Strengths and weaknesses}


\subsection{Strengths}
\begin{itemize}
\item \textbf{Applies widely}\\

\item \textbf{Improve the quality of the airport service}\\

\item \textbf{}\\
\end{itemize}


\begin{appendices}

\section{First appendix}


Here are simulation programmes we used in our model as follow.\\

\textbf{\textcolor[rgb]{0.98,0.00,0.00}{Input matlab source:}}
\lstinputlisting[language=Matlab]{./code/matlab1.m}

\section{Second appendix}

some more text \textcolor[rgb]{0.98,0.00,0.00}{\textbf{Input C++ source:}}
\lstinputlisting[language=C++]{./code/sudoku.cpp}

\end{appendices}

	\nocite{*}

\bibliography{math}

	
\end{document}

